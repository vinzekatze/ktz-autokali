description: Стандартные тесты POP3
author: hacktricks
tags:
  - 110
  - 995
  - pop3
install:
arguments:
  targs:
    default:
    replacer: __TARGS__
    description: >-
      Цели для тестирования (пример: '127.0.0.1:110 127.0.0.2:995')
shell: /bin/bash
script:
item_1:
  description: Тесты nmap
  script: >-
    sudo nmap -sS -Pn -sV --script=pop3-capabilities,pop3-ntlm-info --open -p$(for i in __TARGS__; do echo $i | cut -f2 -d:; done | sort -u | paste -sd",") $(for i in __TARGS__; do echo $i | cut -f1 -d:; done | sort -u | paste -sd" ")
item_2:
  description: Получение банеров с помощью ncat (Авто)
  script: |-
    for i in __TARGS__; do 
      if [[ $(echo $i | cut -f2 -d:) -eq 110 ]]
      then
        echo "Connection to $i:"; echo "QUIT" | ncat -v -w 5 -i 5 $(echo $i | cut -f1 -d:) $(echo $i | cut -f2 -d:); echo
      elif [[ $(echo $i | cut -f2 -d:) -eq 995 ]]
      then
        echo "Connection to $i:"; echo "QUIT" | ncat -v --ssl -w 5 -i 5 $(echo $i | cut -f1 -d:) $(echo $i | cut -f2 -d:); echo
      else
        echo "Connection to $i:"; echo "Нестадартный порт, попробуй вручную"
      fi
    done