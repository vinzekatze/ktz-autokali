description: |-
  Собирает информацию с помощью bloodhound-python.
  Сохранит вывод в директорию запуска.

  Установщик bloodhound тут:
  https://github.com/SpecterOps/bloodhound-cli/releases
author: vinzekatze
tags:
  - active directory
  - bloodhound
arguments:
  domain:
    description: домен
  u:
    default:
      -
    description: логин
    metavar: USER
  p:
    default:
      -
    description: пароль
    metavar: PASS
mode:
  format:
    domain: '{!r}'
    u: ' -u {!r}'
    p: ' -p {!r}'

shell: bash
script: >-
  pref="bld$(echo #u# | sed -E 's/^-u /-/' -)-$(echo #domain#)";
  bloodhound-python -c all -op $pref -d #domain# #u# #p#