description: Парсит json-ы bloodhound
author: vinzekatze
tags:
  - bloodhound output parser

shell: bash

arguments:
  json:
    description: json-файлы bloodhound
    multiple: true

mode:
  format:
    json: '{!r}'

item_1:
  description: Поиск паролей в открытом виде
  script: >-
    jq '.data.[].Properties | select ((.enabled == true)) | select ((.sfupassword != null) or (.unixpassword != null) or (.userpassword != null) or (.unicodepassword != null)) | {name, samaccountname, domain, userpassword, unicodepassword, unixpassword, sfupassword}' #json#
  
item_2: 
  description: Просмотр поля description
  script: >-
    jq '.data.[].Properties | select ((.enabled == true)) | select ((.description != null)) | {name, samaccountname, domain, description}' #json#

item_3:
  description: Список хостнеймов
  script: >-
    jq 'if .meta.type == "computers" then .data.[].Properties.name else "" end' -r #json# 2>/dev/null | sort | uniq

item_4:
  description: Список имен пользователей
  script: >-
    jq 'if .meta.type == "users" then .data.[].Properties | select ((.enabled == true)) | .samaccountname else "" end' -r #json# 2>/dev/null | sort | uniq