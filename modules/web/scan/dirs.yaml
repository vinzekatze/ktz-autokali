description: |-
  Тупо дирсерч на множество целей

author: vinzekatze
tags:
  - directory bruteforce
  - multiple targets

arguments:
  u:
    default:
    multiple: true
    metavar: URL
    description: >-
      URL сайтов с указанием протокола и без слеша в конце (пример: https://yandex.ru http://scanme.org/path)
    replacer: '#url#'
    regex: ^http[s]?:\/\/.*[^\/]$
  t:
    default: 25
    metavar: INT
    description: количество потоков
    replacer: '#threads#'
    regex: '[1-9]\d*'
  d:
    default: 3
    metavar: INT
    description: глубина перечисления субдиректорий
    replacer: '#brutedepth#'
    regex: '[1-9]\d*'

  a:
    default: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:108.0) Gecko/20100101 Firefox/108.0'
    description: User-Agent
    replacer: '#useragent#'
    metavar: STRING
  
  w:
    multiple: true
    default:
      - 
      - 1
      - 2
      - 3
      - 4
      - 5
      - 6
      - 7
      - 8
      - 9
      - 10
      - 11
      - 12
      - 13
      - 14
    description: использовать дополнительный словарь
    replacer: '#addwordlist#'

file_1:
  path: wordlists/web/dirbrute/basic/dirsearch.txt
  description: (1) стандартный словарь dirsearch

file_2:
  path: wordlists/web/dirbrute/basic/quickhits.txt
  description: (2) quickhits из SecLists

file_3:
  path: wordlists/web/dirbrute/basic/directory-list-2.3-small.txt
  description: (3) directory-list-2.3-small из SecLists

file_4:
  path: wordlists/web/dirbrute/basic/directory-list-2.3-medium.txt
  description: (4) directory-list-2.3-medium из SecLists

file_5:
  path: wordlists/web/dirbrute/basic/directory-list-2.3-big.txt
  description: (5) directory-list-2.3-big из SecLists

file_6:
  path: wordlists/web/dirbrute/swagger.txt
  description: (6) директории API-документации

file_7:
  path: wordlists/web/dirbrute/nginx.txt
  description: (7) словарь для nginx

file_8:
  path: wordlists/web/dirbrute/apache.txt
  description: (8) словарь для apache

file_9:
  path: wordlists/web/dirbrute/iis.txt
  description: (9) словарь для iis

file_10:
  path: wordlists/web/dirbrute/oracle.txt
  description: (10) словарь для oracle

file_11:
  path: wordlists/web/dirbrute/tomcat.txt
  description: (11) словарь для tomcat

file_12:
  path: wordlists/web/dirbrute/php.txt
  description: (12) словарь для php

file_13:
  path: wordlists/web/dirbrute/cms/django.txt
  description: (13) словарь для django

file_14:
  path: wordlists/web/dirbrute/cms/sharepoint.txt
  description: (14) словарь для sharepoint


mode:
  loop: u
  format:
    u: '{0!r}'
    t: '{0!r}'
    a: '{0!r}'
    w: '#file_{}#'
  join:
    w: ','

shell: bash
script: |-
  url=#url#
  threads=#threads#
  useragent=#useragent#

  # Подготовка
  scanmarker="$(date +'%Y%m%d_%H%M%S')"
  dirlists='#dirsearch#,#quickhits##addwordlist#'
  dirname="$(echo $url | grep -soP '((?<=^http:\/\/)|(?<=^https:\/\/))(.)(.*?)(?=([\?&#]|$|\/$))' | sed -e 's/[^A-Za-z0-9._-]/_/g').$(echo $url | cut -d ':' -f 1)"
  
  echo -e "\e[1;91mTarget:\e[0m $url"
  mkdir -p ./$dirname && echo -e "\e[1;91mLoot:\e[0m   $(realpath ./$dirname)" || exit

  # Брут директорий
  echo -e "\e[1;92mDirectory bruteforcing...\e[0m"
  dirlists=#addwordlist#
  dirsearch --no-color --quiet-mode --timeout=10 --retries=3 --full-url --include-status 200-208,226,400,401,403,405,500-511 --threads=$threads --user-agent=#useragent# --recursive -R #brutedepth# --wordlists=$dirlists --url=$url | tee ./$dirname/result-dirsearch-$scanmarker.txt
  echo
  echo "Done!"
  echo